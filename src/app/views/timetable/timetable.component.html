<app-header
  [title]="title"
  [subtitle]="('SUBTITLE.timetable' | translate)"
  btnLink="/new-lesson"
  [btnText]="('TITLE.newLesson' | translate)"
></app-header>

<div class="timetable-container">
  <div class="timetable-inner-container timetable-clear" *ngIf="!weeks">
    <div class="loader"></div>
  </div>
  <div class="timetable-inner-container timetable-clear" *ngIf="weeks && objKeys(weeks).length === 0">
    <div class="text">
      <h1 translate>TIMETABLE.title</h1>
      <h2 translate>TIMETABLE.subtitle</h2>
    </div>
  </div>
  <div class="timetable-inner-container" *ngIf="weeks && objKeys(weeks).length !== 0">
    <div class="timetable-week" *ngIf="weeks[currentWeek]">
      <div class="timetable-day" *ngFor="let day of objKeys(weeks[currentWeek])">
        <h1 class="timetable-title" [ngClass]="{'today': getToday() === day}">{{ getTranslatedDay(day) }}</h1>
        <div class="timetable-lesson" *ngFor="let lesson of getValues(currentWeek, day)" (contextmenu)="openContextMenu($event.target, lesson, currentWeek, day)">
          <p class="timetable-lesson-name">{{ lesson['lesson_name'] }}</p>
          <p class="timetable-time">{{ lesson['start_time'] }} - {{ lesson['finish_time'] }}</p>
          <p class="timetable-info">
              <ng-container *ngIf="lesson['class_room']">
                <ng-container *ngIf="lesson['class_room'].startsWith('http'); else classRoomWithNoLink"><span class="is-link" (click)="openLink(lesson['class_room'])">Link</span></ng-container>
                <ng-template #classRoomWithNoLink><span>{{lesson['class_room']}}</span></ng-template>
              </ng-container>
              <ng-container *ngIf="lesson['teacher_name']">
                {{ lesson['class_room'] ? ', ' : '' }}
                {{ lesson['teacher_name'] }}
              </ng-container>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="contextmenu">
  <ul>
    <li appHoldDelete (holdTime)="holdHandler($event)">
      <div class="deletebg" [style.width]="deleteProgress + '%'"></div>
      <i class="eva eva-trash-outline"></i>
      <p translate>CONTEXTMENU.delete</p>
    </li>
    <li routerLink="/edit-lesson">
      <i class="eva eva-edit-2-outline"></i>
      <p translate>CONTEXTMENU.edit</p>
    </li>
  </ul>
</div>